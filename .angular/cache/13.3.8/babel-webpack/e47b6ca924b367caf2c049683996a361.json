{"ast":null,"code":"import { PaintingsService } from '../../services/paintings.service';\nimport { PortraitService } from '../../services/portrait.service';\nimport { InstagramService } from '../../services/instagram.service';\nimport { Global } from '../../services/global';\nimport swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/paintings.service\";\nimport * as i2 from \"../../services/portrait.service\";\nimport * as i3 from \"../../services/instagram.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/platform-browser\";\nimport * as i6 from \"@angular/common\";\n\nconst _c0 = function (a1) {\n  return [\"/admin/change/token/\", a1];\n};\n\nfunction AdminComponent_a_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 8);\n    i0.ɵɵtext(1, \" Actualizar token \");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const token_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(1, _c0, token_r3._id));\n  }\n}\n\nconst _c1 = function (a1) {\n  return [\"/admin/change/portada/\", a1];\n};\n\nfunction AdminComponent_a_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 8);\n    i0.ɵɵtext(1, \" Cambiar portada \");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const portrait_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(1, _c1, portrait_r4._id));\n  }\n}\n\nconst _c2 = function (a1) {\n  return [\"/admin/update/\", a1];\n};\n\nfunction AdminComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"div\", 11)(2, \"div\", 12)(3, \"div\", 13);\n    i0.ɵɵelement(4, \"img\", 14);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(5, \"div\", 15)(6, \"ul\", 16)(7, \"li\", 17)(8, \"h2\", 18);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"li\", 19);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(12, \"div\", 20)(13, \"a\", 21);\n    i0.ɵɵtext(14, \"Editar pintura\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"a\", 22);\n    i0.ɵɵlistener(\"click\", function AdminComponent_div_19_Template_a_click_15_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const painting_r5 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.delete(painting_r5._id);\n    });\n    i0.ɵɵtext(16, \"Borrar pintura\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const painting_r5 = ctx.$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵpropertyInterpolate(\"src\", painting_r5.image0url, i0.ɵɵsanitizeUrl);\n    i0.ɵɵpropertyInterpolate(\"alt\", painting_r5.titulo);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(painting_r5.titulo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", painting_r5.subtitulo, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(5, _c2, painting_r5._id));\n  }\n}\n\nconst _c3 = function () {\n  return [\"/admin/show/users\"];\n};\n\nconst _c4 = function () {\n  return [\"/admin/create\"];\n};\n\nexport let AdminComponent = /*#__PURE__*/(() => {\n  class AdminComponent {\n    constructor(_paintingsService, _portraitService, _instagramService, _route, _router, titleService, metaService) {\n      this._paintingsService = _paintingsService;\n      this._portraitService = _portraitService;\n      this._instagramService = _instagramService;\n      this._route = _route;\n      this._router = _router;\n      this.titleService = titleService;\n      this.metaService = metaService;\n      this.principal = \"Panel de admin\";\n      this.subtitulo = \"Vas a poder crear, editar y eliminar tus pinturas\";\n      this.url = Global.url;\n      titleService.setTitle(\"Admin | Birello Gallery\");\n      this.metaService.addTag({\n        name: 'robots',\n        content: 'noindex, nofollow'\n      });\n    }\n\n    ngOnInit() {\n      window.scroll({\n        top: 0,\n        left: 0,\n        behavior: 'smooth'\n      });\n      this.suscripcion = this._paintingsService.getPaintings().subscribe({\n        next: response => {\n          if (response.paints) {\n            this.paintings = response.paints[0];\n          }\n        }\n      });\n      this.suscripcion2 = this._portraitService.getPortraits().subscribe({\n        next: response => {\n          if (response.portrait) {\n            this.portrait = response.portrait;\n          }\n        }\n      });\n      this.suscripcion3 = this._instagramService.getTokens().subscribe({\n        next: response => {\n          if (response.token) {\n            this.token = response.token;\n          }\n        }\n      });\n    }\n\n    delete(id) {\n      swal.fire({\n        title: '¿ Estas seguro que quieres eliminar esta pintura ?',\n        text: \"No vas a poder recuperarla\",\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonColor: '#3085d6',\n        cancelButtonColor: '#d33',\n        confirmButtonText: 'Si, quiero eliminarla',\n        cancelButtonText: \"Cancelar\"\n      }).then(result => {\n        if (result.isConfirmed) {\n          this._paintingsService.delete(id).subscribe({\n            next: () => {\n              swal.fire('Eliminada', 'La pintura se ha eliminado correctamente', 'success');\n              setTimeout(() => {\n                this._router.navigate(['/admin']).then(() => {\n                  window.location.reload();\n                });\n              }, 2000);\n            },\n            error: () => {\n              swal.fire('Error', 'La pintura no se ha eliminado correctamente', 'error');\n              setTimeout(() => {\n                this._router.navigate(['/admin']).then(() => {\n                  window.location.reload();\n                });\n              }, 2000);\n            }\n          });\n        } else {\n          swal.fire(\"Tu pintura se ha salvado y no se ha eliminado\");\n          setTimeout(() => {\n            this._router.navigate(['/admin']).then(() => {\n              window.location.reload();\n            });\n          }, 2000);\n        }\n      });\n    }\n\n    ngOnDestroy() {\n      [this.suscripcion, this.suscripcion2, this.suscripcion3].forEach(e => e === null || e === void 0 ? void 0 : e.unsubscribe());\n    }\n\n  }\n\n  AdminComponent.ɵfac = function AdminComponent_Factory(t) {\n    return new (t || AdminComponent)(i0.ɵɵdirectiveInject(i1.PaintingsService), i0.ɵɵdirectiveInject(i2.PortraitService), i0.ɵɵdirectiveInject(i3.InstagramService), i0.ɵɵdirectiveInject(i4.ActivatedRoute), i0.ɵɵdirectiveInject(i4.Router), i0.ɵɵdirectiveInject(i5.Title), i0.ɵɵdirectiveInject(i5.Meta));\n  };\n\n  AdminComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AdminComponent,\n    selectors: [[\"app-admin\"]],\n    features: [i0.ɵɵProvidersFeature([PaintingsService, PortraitService, InstagramService])],\n    decls: 20,\n    vars: 9,\n    consts: [[1, \"main\"], [1, \"adminsection\"], [1, \"center\", \"fontcolor\", 2, \"margin-top\", \"20px\", \"margin-bottom\", \"12px\"], [1, \"center\", 2, \"color\", \"#bfbfbf\"], [1, \"container\"], [1, \"row\", \"rowresponsiveapi\"], [1, \"c-col\", \"col-12\", \"col-sm-12\", \"col-md-12\", \"col-lg-12\", \"marginresponsiveindex\", \"alignbuttonadcrear\"], [1, \"no-margin\"], [1, \"btn\", \"btn-lg\", \"btn-painting\", \"fontlargebt\", 3, \"routerLink\"], [\"class\", \"btn btn-lg btn-painting fontlargebt\", 3, \"routerLink\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"row rowresponsiveapi\", 4, \"ngFor\", \"ngForOf\"], [1, \"c-col\", \"col-12\", \"col-sm-6\", \"col-md-5\", \"col-lg-5\", \"marginresponsiveindex\"], [1, \"card-group\"], [1, \"card\"], [1, \"card-img-top\", \"cardmainimg\", 3, \"src\", \"alt\"], [1, \"c-col\", \"col-12\", \"col-sm-6\", \"col-md-5\", \"col-lg-5\", \"verticalcenter\", \"responsiveboxinfo\", \"marginresponsiveindex\"], [1, \"list-group\", \"list-group-flush\", \"colorfontart\"], [1, \"list-group-item\", \"backgroundtransparent\", \"pinturasindexfont\", \"shadowtext\"], [1, \"colorfontart\"], [1, \"list-group-item\", \"backgroundtransparent\", \"colordescripcion\", \"shadowtext\"], [1, \"c-col\", \"col-12\", \"col-sm-12\", \"col-md-2\", \"col-lg-2\", \"alignbuttonad\"], [1, \"btn\", \"btn-painting\", 3, \"routerLink\"], [1, \"btn\", \"btn-painting\", 3, \"click\"]],\n    template: function AdminComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"main\", 0)(1, \"section\", 1)(2, \"h1\", 2);\n        i0.ɵɵtext(3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"p\", 3);\n        i0.ɵɵtext(5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\", 4)(7, \"div\", 5)(8, \"div\", 6)(9, \"p\", 7)(10, \"a\", 8);\n        i0.ɵɵtext(11, \" Ver usuarios registrados \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"p\", 7);\n        i0.ɵɵtemplate(13, AdminComponent_a_13_Template, 2, 3, \"a\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"p\", 7);\n        i0.ɵɵtemplate(15, AdminComponent_a_15_Template, 2, 3, \"a\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"a\", 8);\n        i0.ɵɵtext(17, \"Crear pintura\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(18, \"div\", 4);\n        i0.ɵɵtemplate(19, AdminComponent_div_19_Template, 17, 7, \"div\", 10);\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.principal);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.subtitulo);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(7, _c3));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.token);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.portrait);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(8, _c4));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.paintings);\n      }\n    },\n    directives: [i4.RouterLinkWithHref, i6.NgForOf],\n    styles: [\"\"]\n  });\n  return AdminComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}